rule run
    command = (echo ${out} : ${out}.gen > ${out}.d) && (echo ${out} > ${out})
    depfile = ${out}.d
rule gen
    command = echo ${out} > ${out}
build bad.gen: gen 
    # environment: [[]]
build bad: run  | input
    # environment: [[]]
build good.gen: gen 
    # environment: [[]]
build good: run  || good.gen bad.gen
    # environment: [[]]
